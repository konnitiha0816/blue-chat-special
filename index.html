<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blue Chat Special</title>
    <style>
        /* æ¼†é»’ãƒ†ãƒ¼ãƒ */
        :root { --bg: #000; --panel: #111; --text: #fff; --blue: #007bff; --red: #ff4444; }
        body { margin: 0; background: var(--bg); color: var(--text); font-family: sans-serif; height: 100vh; overflow: hidden; }
        
        /* ç”»é¢å…±é€š */
        .screen { display: none; height: 100vh; flex-direction: column; align-items: center; justify-content: center; }
        .active { display: flex; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* ãƒ‘ãƒ¼ãƒ„ */
        .box { background: var(--panel); padding: 30px; border: 1px solid #333; border-radius: 10px; width: 90%; max-width: 400px; text-align: center; }
        input { width: 100%; padding: 10px; margin: 10px 0; background: #222; border: 1px solid #444; color: #fff; box-sizing: border-box; }
        button { padding: 10px; width: 100%; border: none; border-radius: 5px; cursor: pointer; margin-top: 10px; color: #fff; font-size: 16px; }
        .btn-blue { background: var(--blue); } .btn-red { background: var(--red); }
        
        /* ãƒ¡ã‚¤ãƒ³ç”»é¢æ§‹æˆ */
        #main-area { flex: 1; width: 100%; display: flex; position: relative; margin-top: 50px; }
        #video-grid { flex: 1; display: grid; place-items: center; }
        .card { width: 200px; height: 150px; background: #222; border: 1px solid #444; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        
        #chat-bar { display: none; width: 300px; background: #0a0a0a; border-left: 1px solid #333; flex-direction: column; position: absolute; right: 0; top: 0; bottom: 0; z-index: 100; }
        #chat-log { flex: 1; overflow-y: auto; padding: 10px; }
        .msg { padding: 5px; border-bottom: 1px solid #222; font-size: 14px; }
        
        .controls { height: 70px; width: 100%; background: #111; display: flex; align-items: center; justify-content: center; gap: 10px; border-top: 1px solid #333; }
        .icon { width: 40px; height: 40px; border-radius: 50%; background: #333; color: #fff; border: none; cursor: pointer; }

        /* ãƒ¢ãƒ¼ãƒ€ãƒ« */
        #modal { display: none; position: fixed; top: 20%; background: #222; padding: 20px; border: 1px solid var(--blue); z-index: 200; text-align: center; border-radius: 8px; left: 50%; transform: translateX(-50%); }
    </style>
</head>
<body>
    <div style="position:fixed; top:10px; left:10px; font-weight:bold;">Blue Chat Special</div>
    <div id="role-tag" style="position:fixed; top:10px; right:10px; font-size:12px; color:#888;"></div>

    <div id="s-title" class="screen active" style="background: radial-gradient(circle, #222, #000);">
        <h1>Blue Chat Special</h1>
        <button class="btn-blue" style="width:200px;" onclick="go('s-quiz')">START</button>
    </div>

    <div id="s-quiz" class="screen">
        <div class="box">
            <h2>Security Check</h2>
            <p>7 Ã— 8 = ?</p>
            <input type="number" id="q-ans"><button class="btn-blue" onclick="check()">æ¬¡ã¸</button>
        </div>
    </div>

    <div id="s-mode" class="screen">
        <div class="box">
            <button class="btn-blue" onclick="mode('Host')">ğŸ†• ä½œæˆ</button>
            <button class="btn-blue" style="background:#444;" onclick="mode('Guest')">ğŸ‘¥ å‚åŠ </button>
        </div>
    </div>

    <div id="s-id" class="screen">
        <div class="box">
            <h2 id="id-head">IDè¨­å®š</h2>
            <input id="id-in" placeholder="IDå…¥åŠ›">
            <button class="btn-blue" onclick="setId()">OK</button>
        </div>
    </div>

    <div id="s-prep" class="screen">
        <div class="box">
            <h2>Setup</h2>
            <div style="font-size:40px;">ğŸ“·</div>
            <input id="nick" placeholder="ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ">
            <button class="btn-blue" onclick="enter()">é–‹å§‹</button>
        </div>
    </div>

    <div id="s-wait" class="screen">
        <div class="box"><h2>æ‰¿èªå¾…ã¡...</h2><div style="animation: spin 1s infinite;">â³</div></div>
    </div>

    <div id="s-main" class="screen">
        <div id="main-area">
            <div id="video-grid">
                <div class="card"><span>ğŸ‘¤</span><span id="u-name">è‡ªåˆ†</span></div>
            </div>
            <div id="chat-bar">
                <div id="chat-log"></div>
                <div style="display:flex; padding:5px;"><input id="c-in"><button class="btn-blue" style="width:50px; margin:10px 0 10px 5px;" onclick="send()">â¤</button></div>
            </div>
        </div>
        <div class="controls">
            <button class="icon" onclick="alert('Mic')">ğŸ¤</button>
            <button class="icon" onclick="alert('Cam')">ğŸ“·</button>
            <button class="icon" onclick="toggleChat()">ğŸ’¬</button>
            <button class="icon" style="background:var(--red);" onclick="location.reload()">âŒ</button>
        </div>
    </div>

    <div id="modal">
        <p>ã‚²ã‚¹ãƒˆãŒå‚åŠ ã‚’å¸Œæœ›ã—ã¦ã„ã¾ã™</p>
        <button class="btn-blue" onclick="ok()">æ‰¿èª</button>
        <button class="btn-red" onclick="document.getElementById('modal').style.display='none'">æ‹’å¦</button>
    </div>

    <audio id="bgm-msg" src="message.mp3"></audio>
    <audio id="bgm-req" src="request.mp3"></audio>

    <script>
        let role='', myId='', name='';
        const go = (id) => {
            document.querySelectorAll('.screen').forEach(e=>e.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        };
        const check = () => document.getElementById('q-ans').value=='56' ? go('s-mode') : alert('Error');
        const mode = (r) => { role=r; document.getElementById('id-head').innerText=r==='Host'?'IDä½œæˆ':'IDå…¥åŠ›'; go('s-id'); };
        const setId = () => {
            myId=document.getElementById('id-in').value;
            if(!myId)return;
            go('s-prep');
        };
        const enter = () => {
            name=document.getElementById('nick').value||'User';
            document.getElementById('u-name').innerText=name;
            document.getElementById('role-tag').innerText=role;
            if(role==='Host'){
                go('s-main');
                setTimeout(()=>{
                    document.getElementById('modal').style.display='block';
                    try{document.getElementById('bgm-req').play()}catch(e){}
                },5000);
            } else {
                go('s-wait');
                setTimeout(()=>{alert('Approved!'); go('s-main');},3000);
            }
        };
        const ok = () => {
            document.getElementById('modal').style.display='none';
            document.getElementById('video-grid').innerHTML+='<div class="card"><span>ğŸ‘¤</span><span>Guest</span></div>';
        };
        const toggleChat = () => {
            const b=document.getElementById('chat-bar');
            b.style.display=b.style.display==='flex'?'none':'flex';
        };
        const send = () => {
            const i=document.getElementById('c-in');
            if(!i.value)return;
            document.getElementById('chat-log').innerHTML+=`<div class="msg"><b>${name}:</b> ${i.value}</div>`;
            i.value='';
            try{document.getElementById('bgm-msg').play()}catch(e){}
        };
    </script>
</body>
</html>
